---
import ThemeController from './ThemeController.astro'

const { navLinks = [], themeToggleLabel } = Astro.props
const lastNavIndex = navLinks.length - 1
---

<section
  id="mobile-menu"
  class="mobile-menu fixed left-[3%] top-[4.4rem] w-[94%] lg:hidden text-(--text-primary) z-40 rounded-3xl bg-(--surface-secundary)/80 backdrop-blur-md border border-(--color-border) shadow-lg px-6 py-6"
  aria-label="Main navigation"
  aria-hidden="true"
  hidden
>
  <ul class="flex flex-col items-stretch gap-4 text-left">
    {
      navLinks.map(({ href, label, icon: Icon }, index) => (
        <li class={index === lastNavIndex ? 'flex items-center gap-3' : ''}>
          <a
            href={href}
            data-section-link={href}
            class={`mobile-menu-link flex items-center justify-start gap-3 cursor-pointer text-lg transition-transform duration-100 ease-in-out hover:text-(--color-primary) ${
              index === lastNavIndex ? 'flex-1' : 'w-full'
            }`}
          >
            <span class="mobile-menu-icon">
              <Icon className="w-5 h-5" aria-hidden="true" />
            </span>
            <span>{label}</span>
          </a>
          {index === lastNavIndex && (
            <div class="flex items-center justify-center scale-130">
              <ThemeController ariaLabel={themeToggleLabel} />
            </div>
          )}
        </li>
      ))
    }
  </ul>
</section>

<style>
  .mobile-menu {
    opacity: 0;
    transform: translateY(-8px);
    pointer-events: none;
    transition:
      opacity 200ms ease,
      transform 200ms ease;
  }

  .mobile-menu.open {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  .mobile-menu a.is-active {
    color: var(--color-primary);
  }

  .mobile-menu a .mobile-menu-icon {
    color: #ffffff;
    transition: color 160ms ease;
  }

  .mobile-menu-link {
    padding: 10px 14px;
    border-radius: 8px;
    transition:
      background-color 160ms ease,
      color 160ms ease;
  }

  .mobile-menu-link:hover {
    background-color: #0d1020;
  }

  .mobile-menu-link:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
    background-color: #0d1020;
  }

  .mobile-menu a:hover .mobile-menu-icon,
  .mobile-menu a.is-active .mobile-menu-icon,
  .mobile-menu-link:focus-visible .mobile-menu-icon {
    color: var(--color-primary);
  }
</style>
